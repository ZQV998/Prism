# Prism - 高仿抖音"经验"频道

Prism 是一个高仿抖音"经验"频道的 Android 应用，完全使用 Kotlin 和现代 Android 开发工具构建。项目实现了瀑布流布局、点赞交互、数据刷新等核心功能，并包含多项性能优化和用户体验增强功能。

## 📋 作业要求实现情况

### ✅ 基础功能（作业要求）

#### 1. 瀑布流布局
- ✅ **双列瀑布流界面**：使用 `LazyVerticalStaggeredGrid` 实现抖音经验页的双列瀑布流布局
- ✅ **动态高度适配**：根据图片 URL 自动计算宽高比，实现卡片高度的动态适配，确保瀑布流效果自然流畅

#### 2. 经验卡片 UI 组件
- ✅ **图片展示**：支持网络图片加载，带有占位符和错误处理
- ✅ **标题显示**：支持多行文本显示，超出部分自动省略
- ✅ **用户信息**：包含用户头像（圆形）和用户名显示
- ✅ **点赞功能**：显示点赞图标和点赞数量

#### 3. 点赞交互功能
- ✅ **点赞状态切换**：点击点赞图标可以切换点赞/取消点赞状态
- ✅ **实时更新**：点赞状态和点赞数量实时更新，无需刷新页面
- ✅ **视觉反馈**：已点赞显示红色实心图标，未点赞显示灰色空心图标

#### 4. 数据刷新机制
- ✅ **下拉刷新**：使用 `PullToRefreshBox` 实现下拉刷新最新内容
- ✅ **上拉加载更多**：当用户滚动到列表底部附近时，自动加载更多数据
- ✅ **加载状态指示**：显示加载中的进度指示器，提供清晰的加载反馈

#### 5. 数据配置管理
- ✅ **网络数据源**：从 `picsum.photos` 公共 API 获取图片数据
- ✅ **Mock 数据增强**：在 Repository 层自动生成标题、用户头像、点赞数等测试数据
- ✅ **动态更新**：支持分页加载，数据可动态更新

## 🌟 额外功能

### 1. 预加载优化
- ✅ **智能预加载**：当用户滚动到距离底部 5 个卡片时，自动触发加载更多数据
- ✅ **流畅体验**：预加载机制确保用户滚动时数据已准备就绪，避免等待时间
- ✅ **性能优化**：使用 `LazyVerticalStaggeredGrid` 的懒加载特性，只渲染可见区域的卡片

### 2. 图片缓存
- ✅ **自动缓存**：使用 Coil 图片加载库，自动实现图片缓存策略
- ✅ **淡入动画**：图片加载时使用 `crossfade` 淡入效果，提升视觉体验
- ✅ **占位符**：加载过程中显示占位符，避免空白闪烁
- ✅ **错误处理**：图片加载失败时显示占位符，保证界面完整性

### 3. 布局灵活性
- ✅ **动态切换**：支持在单列和双列布局之间即时切换
- ✅ **一键切换**：顶部工具栏提供布局切换按钮，图标动态变化
- ✅ **状态保持**：布局切换时保持当前滚动位置，用户体验流畅

### 4. 用户体验增强
- ✅ **快速导航**：提供滚动到顶部和滚动到底部的浮动按钮
- ✅ **智能显示**：导航按钮根据滚动位置智能显示/隐藏，带有淡入淡出动画
- ✅ **错误处理**：完善的错误处理机制，支持重试操作
- ✅ **加载状态**：区分初始加载、分页加载、刷新加载等不同状态

### 5. 技术特性
- ✅ **MVVM 架构**：采用 Model-View-ViewModel 架构模式，代码结构清晰
- ✅ **单向数据流**：使用 StateFlow 实现单向数据流，状态管理可预测
- ✅ **依赖注入**：使用 Hilt 进行依赖注入，便于测试和维护
- ✅ **Material 3 设计**：采用 Material 3 设计规范，界面现代化

## 🛠️ 技术栈与核心库

- **UI 框架**：Jetpack Compose, Material 3
- **架构模式**：MVVM (Model-View-ViewModel), 单向数据流 (UDF)
- **依赖注入**：Hilt (Dagger Hilt)
- **网络请求**：Retrofit & OkHttp
- **JSON 解析**：Moshi
- **异步编程**：Kotlin Coroutines & StateFlow
- **图片加载**：Coil (支持自动缓存)
- **布局组件**：LazyVerticalStaggeredGrid (瀑布流)


## 🚀 如何运行

1. 克隆此仓库
   ```bash
   git clone <repository-url>
   ```

2. 在 Android Studio 中打开项目

3. 等待 Gradle 同步依赖项

4. 在模拟器或物理设备上构建并运行

## 📝 项目结构

```
app/src/main/java/com/liuzk/prism/
├── data/
│   ├── model/              # 数据模型
│   ├── remote/             # 网络 API 接口
│   └── repository/         # 数据仓库层
├── di/                     # 依赖注入模块
└── ui/
    └── main/               # 主界面相关
        ├── HomeScreen.kt   # 主界面
        ├── ExperienceCard.kt  # 经验卡片组件
        ├── MainViewModel.kt    # 视图模型
        └── MainUiState.kt      # UI 状态
```

## 🎯 功能亮点

1. **流畅的滚动体验**：预加载机制 + 懒加载布局，确保滚动流畅无卡顿
2. **智能的图片管理**：自动缓存 + 淡入动画 + 占位符，提升视觉体验
3. **灵活的用户交互**：点赞切换 + 布局切换 + 快速导航，操作便捷
4. **完善的状态管理**：统一的 UI 状态管理，处理各种加载和错误场景

## 📄 许可证

本项目为作业项目，仅供学习参考使用。
